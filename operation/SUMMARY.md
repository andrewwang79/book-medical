# 手术
## 流程
1. 门诊和拍片(如CT)
1. 诊断(含技师诊断)
1. 术前规划
1. 手术：术中导航，器械手术

## 系统构成
* 软件：术前规划软件，术中导航软件，手术器械操作软件
* 硬件：手术器械

## 数字手术

| 驾驶 | 手术 |
| :-: | - |
| [数字地图](https://zhuanlan.zhihu.com/p/102374698) | 数字人体 |
| 路线规划 | 手术路径规划 |
| 导航 | 术中导航 |
| 自动驾驶 | 自动手术 |

### 数字人体
| 项 | 驾驶 | 手术 | 说明 |
| :-: | - | - | - |
| 采集 | 地图采集车 | CT/MR设备 |  |
| 建模 | PoI标注 | 目标分割、多模态影像融合 | POI(points of interest)关键兴趣点 |

### 手术路径规划
| 项 | 驾驶 | 手术 | 说明 |
| :-: | - | - | - |
| 设置起点终点 | 目的地设置 | 病灶分割 |  |
| 路线生成和选择 | 路径自动生成、选择 | 路径自动生成、编辑、选择 |  |

### 术中导航
| 项 | 驾驶 | 手术 | 说明 |
| :-: | - | - | - |
| 定位 | GPS | [电磁传感](https://www.ndigital.cn/%E6%8A%80%E6%9C%AF/%E7%94%B5%E7%A3%81%E8%B7%9F%E8%B8%AA/)、[光纤传感](https://fiber.ofweek.com/2022-09/ART-12008-2100-30575190.html)、[光学定位](https://www.ndigital.cn/%E4%BA%A7%E5%93%81/polaris-vega/) |  |
| 配准 | GPS和地图用的同一坐标系，不需要配准 | 通过关键点和点云配准"磁空间坐标系"和"数字世界坐标系"，获取变换矩阵 | 配准数字世界(如虚拟内窥镜)和现实世界(如内窥镜) |
| 融合显示 | 车在地图上显示 | 数字人体(器官、血管)在现实器械所在的画面上显示 |  |
| 实时更新 | 堵车 | 路径微调 | 更新器官形变等信息(如呼吸导致的器官形变) |
| 碰撞预警 | 撞车报警 | 器械 | 器械不能碰动脉 |

### 自动手术
| 项 | 驾驶 | 手术 | 说明 |
| :-: | - | - | - |
| 自动 | 自动驾驶 | 算法决策并控制机器人进行手术操作 | L1：辅助医生进行重复性较高且简单的操作 <br> L2：在医生的监控下进行复杂操作。如缝合、切除，内窥镜的自动进镜。 |

* 医疗行业标准制订中，比如描述法8级，权重法(连续数字)
* [自动驾驶分级是0-5级别](https://new.qq.com/rain/a/20210309A0CAN000), http://m.cheyun.com/content/22813

![自动驾驶分级](../s/operation/autopilot.jpg)

## 技术
### 呼吸补偿的精准穿刺
* 本质是象位对齐，CT一般都是吸气相。
* 当前常用方法：医生通过(在导管头部的2mm直径)超声探路，最终导管到达目标点。从导管中撤出超声探头，进行后续穿刺。缺点是超声有角度范围限制，角度太大或距离太远的很难找，需要医生有经验。
* 探索的方法
    1. 基于CBCT和CT做相位配准，获取配准时对应的呼吸机状态，将呼吸机暂停在此状态后做穿刺
    1. 基于超声和超声上的定位，将超声获取的局部影像，通过定位映射到CT上(全局影像)，引导超声到达目标点。解决当前常用方法的缺点
    1. 基于术前和术中的潮气量，在术中将呼吸机暂停在此状态后做穿刺
    1. 纯术中象位检测验证，前提是自主被动呼吸的吸气象差不多？？？
